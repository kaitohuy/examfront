<div class="loading-overlay" [class.blur]="blurBackground" [class.embedded]="embedded">
  <div class="loading-card">
    <div class="spinner-logo" aria-hidden="true">
      <svg class="spinner-icon" viewBox="0 0 44 44" role="img" aria-label="Đang tải">
        <g class="ring" fill="none" stroke="#e23b3b" stroke-width="2" stroke-linecap="round">
          <circle cx="22" cy="22" r="18" pathLength="100" stroke-dasharray="15 10" />
        </g>
        <g class="caps" transform="translate(22 22)" fill="#e23b3b">
          <circle class="dot" r="3.2" transform="rotate(0)   translate(0,-18)" />
          <circle class="dot" r="3.2" transform="rotate(90)  translate(0,-18)" />
          <circle class="dot" r="3.2" transform="rotate(180) translate(0,-18)" />
          <circle class="dot" r="3.2" transform="rotate(270) translate(0,-18)" />
        </g>
      </svg>
    </div>

    <h2 class="title">{{ title }}</h2>
    <p class="subtitle">{{ subtitle }}</p>

    <div *ngIf="showProgressBar" class="progress-wrap" aria-live="polite">
      <div class="ls-progress">
        <!-- determinate -->
        <div *ngIf="progress !== null; else indeterminate"
             class="ls-progress-bar determinate"
             [style.transform]="'scaleX(' + (safeProgress/100) + ')'">
        </div>
        <!-- indeterminate -->
        <ng-template #indeterminate>
          <div class="ls-progress-bar indeterminate"></div>
        </ng-template>
      </div>
      <div class="progress-label">
        {{ progress !== null ? (safeProgress + '%') : 'Đang xử lý…' }}
      </div>
    </div>

    <p class="hint"><span class="hint-line">{{ hintPrefix }}</span><br></p>
    <p class="action-link"><a href="#" (click)="onActionClick($event)">{{ actionText }}</a></p>

    <ng-content select=".footer"></ng-content>
  </div>
</div>
